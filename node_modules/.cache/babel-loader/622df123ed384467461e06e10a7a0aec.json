{"ast":null,"code":"import * as React from 'react';\nimport { useGridSelector, useGridApiEventHandler, useGridApiOptionHandler, gridVisibleColumnDefinitionsSelector, gridRowsMetaSelector, GridFeatureModeConstant } from '@mui/x-data-grid';\nimport { useGridVisibleRows } from '@mui/x-data-grid/internals';\n/**\n * @requires useGridColumns (state)\n * @requires useGridDimensions (method) - can be after\n * @requires useGridScroll (method\n */\n\nexport const useGridInfiniteLoader = (apiRef, props) => {\n  const visibleColumns = useGridSelector(apiRef, gridVisibleColumnDefinitionsSelector);\n  const currentPage = useGridVisibleRows(apiRef, props);\n  const rowsMeta = useGridSelector(apiRef, gridRowsMetaSelector);\n  const contentHeight = Math.max(rowsMeta.currentPageTotalHeight, 1);\n  const isInScrollBottomArea = React.useRef(false);\n  const handleRowsScrollEnd = React.useCallback(scrollPosition => {\n    const dimensions = apiRef.current.getRootDimensions(); // Prevent the infite loading working in combination with lazy loading\n\n    if (!dimensions || props.rowsLoadingMode !== GridFeatureModeConstant.client) {\n      return;\n    }\n\n    const scrollPositionBottom = scrollPosition.top + dimensions.viewportOuterSize.height;\n    const viewportPageSize = apiRef.current.unstable_getViewportPageSize();\n\n    if (scrollPositionBottom < contentHeight - props.scrollEndThreshold) {\n      isInScrollBottomArea.current = false;\n    }\n\n    if (scrollPositionBottom >= contentHeight - props.scrollEndThreshold && !isInScrollBottomArea.current) {\n      const rowScrollEndParam = {\n        visibleColumns,\n        viewportPageSize,\n        virtualRowsCount: currentPage.rows.length\n      };\n      apiRef.current.publishEvent('rowsScrollEnd', rowScrollEndParam);\n      isInScrollBottomArea.current = true;\n    }\n  }, [contentHeight, props.scrollEndThreshold, props.rowsLoadingMode, visibleColumns, apiRef, currentPage.rows.length]);\n  const handleGridScroll = React.useCallback(_ref => {\n    let {\n      left,\n      top\n    } = _ref;\n    handleRowsScrollEnd({\n      left,\n      top\n    });\n  }, [handleRowsScrollEnd]);\n  useGridApiEventHandler(apiRef, 'rowsScroll', handleGridScroll);\n  useGridApiOptionHandler(apiRef, 'rowsScrollEnd', props.onRowsScrollEnd);\n};","map":{"version":3,"names":["React","useGridSelector","useGridApiEventHandler","useGridApiOptionHandler","gridVisibleColumnDefinitionsSelector","gridRowsMetaSelector","GridFeatureModeConstant","useGridVisibleRows","useGridInfiniteLoader","apiRef","props","visibleColumns","currentPage","rowsMeta","contentHeight","Math","max","currentPageTotalHeight","isInScrollBottomArea","useRef","handleRowsScrollEnd","useCallback","scrollPosition","dimensions","current","getRootDimensions","rowsLoadingMode","client","scrollPositionBottom","top","viewportOuterSize","height","viewportPageSize","unstable_getViewportPageSize","scrollEndThreshold","rowScrollEndParam","virtualRowsCount","rows","length","publishEvent","handleGridScroll","left","onRowsScrollEnd"],"sources":["/Users/dewan03/project/project/node_modules/@mui/x-data-grid-pro/hooks/features/infiniteLoader/useGridInfiniteLoader.js"],"sourcesContent":["import * as React from 'react';\nimport { useGridSelector, useGridApiEventHandler, useGridApiOptionHandler, gridVisibleColumnDefinitionsSelector, gridRowsMetaSelector, GridFeatureModeConstant } from '@mui/x-data-grid';\nimport { useGridVisibleRows } from '@mui/x-data-grid/internals';\n\n/**\n * @requires useGridColumns (state)\n * @requires useGridDimensions (method) - can be after\n * @requires useGridScroll (method\n */\nexport const useGridInfiniteLoader = (apiRef, props) => {\n  const visibleColumns = useGridSelector(apiRef, gridVisibleColumnDefinitionsSelector);\n  const currentPage = useGridVisibleRows(apiRef, props);\n  const rowsMeta = useGridSelector(apiRef, gridRowsMetaSelector);\n  const contentHeight = Math.max(rowsMeta.currentPageTotalHeight, 1);\n  const isInScrollBottomArea = React.useRef(false);\n  const handleRowsScrollEnd = React.useCallback(scrollPosition => {\n    const dimensions = apiRef.current.getRootDimensions(); // Prevent the infite loading working in combination with lazy loading\n\n    if (!dimensions || props.rowsLoadingMode !== GridFeatureModeConstant.client) {\n      return;\n    }\n\n    const scrollPositionBottom = scrollPosition.top + dimensions.viewportOuterSize.height;\n    const viewportPageSize = apiRef.current.unstable_getViewportPageSize();\n\n    if (scrollPositionBottom < contentHeight - props.scrollEndThreshold) {\n      isInScrollBottomArea.current = false;\n    }\n\n    if (scrollPositionBottom >= contentHeight - props.scrollEndThreshold && !isInScrollBottomArea.current) {\n      const rowScrollEndParam = {\n        visibleColumns,\n        viewportPageSize,\n        virtualRowsCount: currentPage.rows.length\n      };\n      apiRef.current.publishEvent('rowsScrollEnd', rowScrollEndParam);\n      isInScrollBottomArea.current = true;\n    }\n  }, [contentHeight, props.scrollEndThreshold, props.rowsLoadingMode, visibleColumns, apiRef, currentPage.rows.length]);\n  const handleGridScroll = React.useCallback(({\n    left,\n    top\n  }) => {\n    handleRowsScrollEnd({\n      left,\n      top\n    });\n  }, [handleRowsScrollEnd]);\n  useGridApiEventHandler(apiRef, 'rowsScroll', handleGridScroll);\n  useGridApiOptionHandler(apiRef, 'rowsScrollEnd', props.onRowsScrollEnd);\n};"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,eAAT,EAA0BC,sBAA1B,EAAkDC,uBAAlD,EAA2EC,oCAA3E,EAAiHC,oBAAjH,EAAuIC,uBAAvI,QAAsK,kBAAtK;AACA,SAASC,kBAAT,QAAmC,4BAAnC;AAEA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,qBAAqB,GAAG,CAACC,MAAD,EAASC,KAAT,KAAmB;EACtD,MAAMC,cAAc,GAAGV,eAAe,CAACQ,MAAD,EAASL,oCAAT,CAAtC;EACA,MAAMQ,WAAW,GAAGL,kBAAkB,CAACE,MAAD,EAASC,KAAT,CAAtC;EACA,MAAMG,QAAQ,GAAGZ,eAAe,CAACQ,MAAD,EAASJ,oBAAT,CAAhC;EACA,MAAMS,aAAa,GAAGC,IAAI,CAACC,GAAL,CAASH,QAAQ,CAACI,sBAAlB,EAA0C,CAA1C,CAAtB;EACA,MAAMC,oBAAoB,GAAGlB,KAAK,CAACmB,MAAN,CAAa,KAAb,CAA7B;EACA,MAAMC,mBAAmB,GAAGpB,KAAK,CAACqB,WAAN,CAAkBC,cAAc,IAAI;IAC9D,MAAMC,UAAU,GAAGd,MAAM,CAACe,OAAP,CAAeC,iBAAf,EAAnB,CAD8D,CACP;;IAEvD,IAAI,CAACF,UAAD,IAAeb,KAAK,CAACgB,eAAN,KAA0BpB,uBAAuB,CAACqB,MAArE,EAA6E;MAC3E;IACD;;IAED,MAAMC,oBAAoB,GAAGN,cAAc,CAACO,GAAf,GAAqBN,UAAU,CAACO,iBAAX,CAA6BC,MAA/E;IACA,MAAMC,gBAAgB,GAAGvB,MAAM,CAACe,OAAP,CAAeS,4BAAf,EAAzB;;IAEA,IAAIL,oBAAoB,GAAGd,aAAa,GAAGJ,KAAK,CAACwB,kBAAjD,EAAqE;MACnEhB,oBAAoB,CAACM,OAArB,GAA+B,KAA/B;IACD;;IAED,IAAII,oBAAoB,IAAId,aAAa,GAAGJ,KAAK,CAACwB,kBAA9C,IAAoE,CAAChB,oBAAoB,CAACM,OAA9F,EAAuG;MACrG,MAAMW,iBAAiB,GAAG;QACxBxB,cADwB;QAExBqB,gBAFwB;QAGxBI,gBAAgB,EAAExB,WAAW,CAACyB,IAAZ,CAAiBC;MAHX,CAA1B;MAKA7B,MAAM,CAACe,OAAP,CAAee,YAAf,CAA4B,eAA5B,EAA6CJ,iBAA7C;MACAjB,oBAAoB,CAACM,OAArB,GAA+B,IAA/B;IACD;EACF,CAvB2B,EAuBzB,CAACV,aAAD,EAAgBJ,KAAK,CAACwB,kBAAtB,EAA0CxB,KAAK,CAACgB,eAAhD,EAAiEf,cAAjE,EAAiFF,MAAjF,EAAyFG,WAAW,CAACyB,IAAZ,CAAiBC,MAA1G,CAvByB,CAA5B;EAwBA,MAAME,gBAAgB,GAAGxC,KAAK,CAACqB,WAAN,CAAkB,QAGrC;IAAA,IAHsC;MAC1CoB,IAD0C;MAE1CZ;IAF0C,CAGtC;IACJT,mBAAmB,CAAC;MAClBqB,IADkB;MAElBZ;IAFkB,CAAD,CAAnB;EAID,CARwB,EAQtB,CAACT,mBAAD,CARsB,CAAzB;EASAlB,sBAAsB,CAACO,MAAD,EAAS,YAAT,EAAuB+B,gBAAvB,CAAtB;EACArC,uBAAuB,CAACM,MAAD,EAAS,eAAT,EAA0BC,KAAK,CAACgC,eAAhC,CAAvB;AACD,CAzCM"},"metadata":{},"sourceType":"module"}